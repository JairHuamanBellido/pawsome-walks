---
import { PageService } from "../../lib/domain/services/PageService";
import Layout from "../../layout/layout.astro";
import HeroBanner from "../../components/HeroBanner.astro";
const { slug } = Astro.params;

const parseSlug = slug ?? "home";
const page = await PageService.findBySlug({
  slug: parseSlug,
  locale: Astro.currentLocale ?? "en",
});

if (!page) return Astro.redirect("/404");

const { seo, title, sections } = page;
---

<Layout title={title} description={seo.metaDescription}>
  {
    sections.map((component) => {
      const mapperComponent: { [key: string]: any } = {
        HeroBanner,
      };
      const Component = mapperComponent[component.id];

      if (Component) {
        const rest = component;
        return <Component {...rest} />;
      }
      return null;
    })
  }
</Layout>
